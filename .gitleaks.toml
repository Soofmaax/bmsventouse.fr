title = "BMS Ventouse - gitleaks config (allowlist for public identifiers)"

[allowlist]
description = "Allow non-secret public identifiers and site-verification keys that are expected to be public."
# Regex-based allowlist for content that may look like secrets but are intentionally public.
regexes = [
  # Google Analytics 4 Measurement IDs, e.g., G-VCB3QB5P4L
  '''\bG-[A-Z0-9]{6,}\b''',
  # GA4 loader URL including the ID
  '''https://www\.googletagmanager\.com/gtag/js\?id=G-[A-Z0-9]{6,}''',

  # Google Tag Manager Container IDs (public)
  '''\bGTM-[A-Z0-9]{5,}\b''',

  # Microsoft Clarity project ID (allow matching the bare ID token as well)
  '''"clarity",\s*"script",\s*"[a-z0-9]{8,12}"''',
  '''\btm9ex1xsa4\b''',

  # IndexNow ownership key in content or file references (public by design)
  '''\bindexnow-[a-f0-9]{32}\b''',

  # Specific IndexNow key literal used in scripts/indexnow-submit.js (public)
  '''\b4f9c42a5b1e34cb08b65e0a9d3c7f864\b''',

  # Public WhatsApp contact links
  '''https?://wa\.me/\d+''',

  # Public contact email used on the site (generic email allowlist to avoid false positives)
  '''[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}''',

  # International phone numbers like +33 6 46 00 56 42 (allowlist common phone formats)
  '''\+\d{1,3}(?:[ \u00A0\-]?\d){6,}''',

  # Zoho OAuth token header literal (no secrets committed in code)
  '''\bZoho-oauthtoken\b''',

  # OAuth token exchange URL patterns (env-based values; code may include these literals)
  '''/oauth/v2/token\?refresh_token=.*&client_id=.*&client_secret=.*&grant_type=refresh_token'''
]

# Path-based allowlist for files that intentionally contain public verification keys or OAuth flows
paths = [
  # IndexNow key file present at repo root, required to be public
  '''^indexnow-[a-f0-9]{32}\.txt''',
  # Netlify serverless with OAuth flows (values come from environment; no hard-coded secrets)
  '''^netlify/functions/zoho_.*\.js''
]